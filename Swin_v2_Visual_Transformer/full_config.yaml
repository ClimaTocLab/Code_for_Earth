!!python/object:jsonargparse._namespace.Namespace
config: null
subcommand: fit
fit: !!python/object:jsonargparse._namespace.Namespace
  config:
  - !!python/object:jsonargparse._util.Path
    _skip_check: false
    _std_io: false
    _relative: configs/test.yaml
    _absolute: /home/cide/Documents/5.-Downscaling/downscaling-SwinFSD/configs/test.yaml
    _cwd: /home/cide/Documents/5.-Downscaling/downscaling-SwinFSD
    _mode: fsr
    _is_url: false
    _is_fsspec: false
    _url_data: null
  seed_everything: 42
  trainer: !!python/object:jsonargparse._namespace.Namespace
    accelerator: gpu
    strategy: auto
    devices: auto
    num_nodes: 1
    precision: null
    logger: !!python/object:jsonargparse._namespace.Namespace
      class_path: lightning.pytorch.loggers.WandbLogger
      init_args: !!python/object:jsonargparse._namespace.Namespace
        name: AirPollution
        save_dir: .
        version: null
        offline: false
        dir: null
        id: null
        anonymous: null
        project: downscaling-swinfir
        log_model: false
        experiment: null
        prefix: ''
        checkpoint_name: null
        entity: marcos-unizar-csic
        notes: null
        tags:
        - swinFIR
        - 4x
        - u10/v10
        config: null
        config_exclude_keys: null
        config_include_keys: null
        allow_val_change: null
        group: era2cerra
        job_type: train
        mode: null
        force: null
        reinit: null
        resume: null
        resume_from: null
        fork_from: null
        save_code: null
        tensorboard: null
        sync_tensorboard: null
        monitor_gym: null
        settings: null
    callbacks: null
    fast_dev_run: false
    max_epochs: 3
    min_epochs: null
    max_steps: -1
    min_steps: null
    max_time: 00:23:00:00
    limit_train_batches: null
    limit_val_batches: null
    limit_test_batches: null
    limit_predict_batches: null
    overfit_batches: 0.0
    val_check_interval: 1.0
    check_val_every_n_epoch: 1
    num_sanity_val_steps: 0
    log_every_n_steps: null
    enable_checkpointing: null
    enable_progress_bar: true
    enable_model_summary: true
    accumulate_grad_batches: 1
    gradient_clip_val: null
    gradient_clip_algorithm: null
    deterministic: null
    benchmark: null
    inference_mode: true
    use_distributed_sampler: true
    profiler: null
    detect_anomaly: false
    barebones: false
    plugins: null
    sync_batchnorm: false
    reload_dataloaders_every_n_epochs: 0
    default_root_dir: null
    model_registry: null
  model: !!python/object:jsonargparse._namespace.Namespace
    class_path: models.swin_fir.swin_fir.SwinFIR_sidechannel
    init_args: !!python/object:jsonargparse._namespace.Namespace
      img_size: 35
      patch_size: 1
      in_chans: 6
      out_chans: 1
      out_channels: null
      embed_dim: 220
      depths:
      - 5
      - 5
      - 5
      - 5
      - 5
      num_heads:
      - 6
      - 6
      - 6
      - 6
      - 6
      window_size: 7
      mlp_ratio: 2
      qkv_bias: true
      qk_scale: null
      drop_rate: 0.0
      attn_drop_rate: 0.0
      drop_path_rate: 0.1
      ape: false
      patch_norm: true
      use_checkpoint: false
      upscale: 4
      img_range: 1.0
      upsampler: pixelshuffledirect
      resi_connection: HSFB
      dataset_metrics_cerra: {}
      dataset_metrics_era: {}
      learning_rate: 0.00015
      channel_names: &id001
      - pm2p5
      - blh
      - u10
      - v10
      - d2m
      - t2d
      num_sidechannels: 2
      embed_dim_sidechannels: 20
      loss_beta: 0.6
      weights_from_checkpoint_path: null
      loss_function: mse
      lr_scheduling: false
      weight_decay: 0.0
      full_height_cerra: 420
      full_width_cerra: 700
      transform: true
      standarized: true
      metrics_names:
      - l1Error
      - l2Error
      - Bias_time
      - Bias_space
      - Corr_time
      - Corr_space
      - RMSE_time
      - RMSE_space
      - PeakSignalNoiseRatio
      - StructuralSimilarityIndexMeasure
      - UniversalImageQualityIndex
      land_mask_bool: false
      results_dir: output_lr_0p00015_bs_True_emb_220_emb_sd_20
  data: !!python/object:jsonargparse._namespace.Namespace
    class_path: dataset_utils.LightningDataModules.Era2CerraDataModule
    init_args: !!python/object:jsonargparse._namespace.Namespace
      data_path: data/
      downscaling_factor: 1
      num_workers: 8
      batch_size: 8
      crop_size_era: 35
      crop_size_cerra: 140
      cropping: deterministic
      masking_prob: 0.5
      channel_names: *id001
      local_testing: false
      constant_channels: true
      lat_lon_const_channels: false
      return_era_original: false
      spatial_split_train: null
      spatial_split_val: null
      spatial_split_test: null
      return_offset: true
      out_channels: null
      in_channels: null
      transform: true
      standarized: true
      use_added_variables_dataset: false
      use_separate_dataset: true
  default_early_stopping: !!python/object:jsonargparse._namespace.Namespace
    monitor: val_loss
    min_delta: 0.0
    patience: 100
    verbose: true
    mode: min
    strict: true
    check_finite: true
    stopping_threshold: null
    divergence_threshold: null
    check_on_train_epoch_end: null
    log_rank_zero_only: false
  default_checkpoint: !!python/object:jsonargparse._namespace.Namespace
    dirpath: output_lr_0p00015_bs_True_emb_220_emb_sd_20/models
    filename: example-{epoch:02d}-{val_loss:.4f}
    monitor: val_loss
    verbose: true
    save_last: true
    save_top_k: 1
    save_weights_only: false
    mode: min
    auto_insert_metric_name: true
    every_n_train_steps: null
    train_time_interval: null
    every_n_epochs: null
    save_on_train_epoch_end: null
    enable_version_counter: false
  default_lr_monitor: !!python/object:jsonargparse._namespace.Namespace
    logging_interval: epoch
    log_momentum: false
    log_weight_decay: false
  optimizer: null
  lr_scheduler: null
  ckpt_path: null
